{"ast":null,"code":"import { openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, withModifiers as _withModifiers, createTextVNode as _createTextVNode, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"login\"\n};\nconst _hoisted_2 = /*#__PURE__*/_createElementVNode(\"h2\", null, \"管理员登录\", -1 /* HOISTED */);\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"username\"\n}, \"用户名:\", -1 /* HOISTED */);\nconst _hoisted_4 = /*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"password\"\n}, \"密码:\", -1 /* HOISTED */);\nconst _hoisted_5 = /*#__PURE__*/_createElementVNode(\"button\", {\n  type: \"submit\"\n}, \"登录\", -1 /* HOISTED */);\nconst _hoisted_6 = {\n  key: 1,\n  class: \"alert\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [$setup.headerVisible ? (_openBlock(), _createBlock($setup[\"HeaderNav\"], {\n    key: 0\n  })) : _createCommentVNode(\"v-if\", true), _hoisted_2, _createElementVNode(\"form\", {\n    onSubmit: _withModifiers($setup.handleLogin, [\"prevent\"])\n  }, [_createElementVNode(\"div\", null, [_hoisted_3, _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.username = $event),\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.username]])]), _createElementVNode(\"div\", null, [_hoisted_4, _withDirectives(_createElementVNode(\"input\", {\n    type: \"password\",\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.password = $event),\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.password]])]), _hoisted_5], 32 /* NEED_HYDRATION */), $setup.loginFailed ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [_createTextVNode(\" 登录失败：服务器错误 \"), _createElementVNode(\"button\", {\n    onClick: $setup.closeAlert\n  }, \"关闭\")])) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["class","_createElementVNode","for","type","key","_createElementBlock","_hoisted_1","$setup","headerVisible","_createBlock","_createCommentVNode","_hoisted_2","onSubmit","_withModifiers","handleLogin","_hoisted_3","_cache","$event","username","required","_hoisted_4","password","_hoisted_5","loginFailed","_hoisted_6","_createTextVNode","onClick","closeAlert"],"sources":["C:\\Users\\wu\\Desktop\\软工\\springboot_vue\\demo_vue\\src\\views\\LoginView.vue"],"sourcesContent":["<template>\r\n  <div class=\"login\">\r\n    <header-nav v-if=\"headerVisible\"></header-nav>\r\n    <h2>管理员登录</h2>\r\n    <form @submit.prevent=\"handleLogin\">\r\n      <div>\r\n        <label for=\"username\">用户名:</label>\r\n        <input type=\"text\" v-model=\"username\" required />\r\n      </div>\r\n      <div>\r\n        <label for=\"password\">密码:</label>\r\n        <input type=\"password\" v-model=\"password\" required />\r\n      </div>\r\n      <button type=\"submit\">登录</button>\r\n    </form>\r\n    <div v-if=\"loginFailed\" class=\"alert\">\r\n      登录失败：服务器错误\r\n      <button @click=\"closeAlert\">关闭</button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { computed, watch, watchEffect, ref } from 'vue';\r\nimport { useRoute, useRouter } from 'vue-router';\r\nimport HeaderNav from './components/HeaderNav.vue';\r\nimport useUserStore from './store/user-store';\r\nimport SocketService from './utils/web-stocket-service.js';\r\nimport { mapActions } from 'vuex';\r\n\r\nconst userStore = useUserStore();\r\nconst route = useRoute();\r\nconst router = useRouter();\r\nconst headerVisible = ref(true);\r\nconst username = ref('');\r\nconst password = ref('');\r\nconst loginFailed = ref(false);\r\n\r\nconst { login } = mapActions(['login']);\r\n\r\nif (userStore.isLogin) {\r\n  userStore.getUserInfo();\r\n  userStore.getBaseUserInfo();\r\n}\r\n\r\n// 登录成功后连接\r\nwatchEffect(() => {\r\n  if (userStore.isLogin) {\r\n    const socketServe = SocketService.Instance;\r\n    socketServe.route = route;\r\n    socketServe.router = router;\r\n    socketServe.connect();\r\n    console.log(\"已登录：连接websocket\");\r\n  }\r\n});\r\n\r\n// 监听路由变化\r\nwatch(() => route.name, () => {\r\n  const meta = route.meta;\r\n  let title = meta['title'];\r\n  let header = meta['header'];\r\n  headerVisible.value = header !== undefined ? header : true;\r\n  document.title = \"为考\" + (title ? \"-\" + title : \"\");\r\n});\r\n\r\nasync function handleLogin() {\r\n  try {\r\n    const result = await login({ username: username.value, password: password.value });\r\n    if (result.success) {\r\n      router.push('/dashboard');\r\n    } else {\r\n      alert('登录失败：' + result.message);\r\n    }\r\n  } catch (error) {\r\n    console.error('登录失败：', error);\r\n    alert('登录失败：服务器错误');\r\n    loginFailed.value = true;\r\n  }\r\n}\r\n\r\nfunction closeAlert() {\r\n  loginFailed.value = false;\r\n}\r\n</script>\r\n\r\n<style lang=\"less\">\r\nbody,\r\ntextarea {\r\n  font-family: Helvetica Neue, Helvetica, PingFang SC, Microsoft YaHei, Source Han Sans SC, Noto Sans CJK SC, WenQuanYi Micro Hei, sans-serif;\r\n}\r\n\r\n.ebutton-hover {\r\n  transition: all .3s;\r\n  border-radius: 5px;\r\n  cursor: pointer;\r\n  padding: 15px;\r\n\r\n  &:hover {\r\n    background-color: var(--color-fill-2);\r\n  }\r\n}\r\n\r\n.arco-page-header-wrapper {\r\n  padding-left: 0px !important;\r\n}\r\n\r\n.arco-modal-simple .arco-modal-body {\r\n  overflow: hidden;\r\n}\r\n\r\n.arco-avatar-image img {\r\n  object-fit: cover;\r\n}\r\n\r\ndiv::-webkit-scrollbar,\r\nbody::-webkit-scrollbar,\r\nul::-webkit-scrollbar {\r\n  /* 滚动条整体样式 */\r\n  width: 5px;\r\n  /* 高宽分别对应横竖滚动条的尺寸 */\r\n  height: 1px;\r\n}\r\n\r\ndiv::-webkit-scrollbar-thumb,\r\nbody::-webkit-scrollbar-thumb,\r\nul::-webkit-scrollbar-thumb {\r\n  /* 滚动条里面小方块 */\r\n  border-radius: 10px;\r\n  box-shadow: inset 0 0 5px rgba(219, 219, 219, 0.5);\r\n  background: #d6d6d6;\r\n}\r\n\r\ndiv::-webkit-scrollbar-track,\r\nbody::-webkit-scrollbar-track,\r\nul::-webkit-scrollbar-track {\r\n  /* 滚动条里面轨道 */\r\n  box-shadow: inset 0 0 5px rgba(255, 255, 255, 0.8);\r\n  border-radius: 10px;\r\n  background: #ffffff;\r\n}\r\n\r\n@media only screen and (max-width: 600px) {\r\n  .arco-modal-simple {\r\n    width: 100% !important;\r\n    box-sizing: border-box;\r\n  }\r\n}\r\n\r\n.login {\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n  height: 100vh;\r\n  background-color: #f0f2f5;\r\n}\r\n\r\nform {\r\n  background: white;\r\n  padding: 2rem;\r\n  border-radius: 5px;\r\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\nform div {\r\n  margin-bottom: 1rem;\r\n}\r\n\r\nbutton {\r\n  width: 100%;\r\n  padding: 0.5rem;\r\n  background: #1890ff;\r\n  border: none;\r\n  color: white;\r\n  border-radius: 5px;\r\n  cursor: pointer;\r\n}\r\n\r\nbutton:hover {\r\n  background: #40a9ff;\r\n}\r\n\r\n.alert {\r\n  margin-top: 1rem;\r\n  padding: 1rem;\r\n  background: #f8d7da;\r\n  color: #721c24;\r\n  border: 1px solid #f5c6cb;\r\n  border-radius: 5px;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n</style>\r\n"],"mappings":";;EACOA,KAAK,EAAC;AAAO;gCAEhBC,mBAAA,CAAc,YAAV,OAAK;gCAGLA,mBAAA,CAAkC;EAA3BC,GAAG,EAAC;AAAU,GAAC,MAAI;gCAI1BD,mBAAA,CAAiC;EAA1BC,GAAG,EAAC;AAAU,GAAC,KAAG;gCAG3BD,mBAAA,CAAiC;EAAzBE,IAAI,EAAC;AAAQ,GAAC,IAAE;;EAb9BC,GAAA;EAe4BJ,KAAK,EAAC;;;uBAdhCK,mBAAA,CAkBM,OAlBNC,UAkBM,GAjBcC,MAAA,CAAAC,aAAa,I,cAA/BC,YAAA,CAA8CF,MAAA;IAFlDH,GAAA;EAAA,MAAAM,mBAAA,gBAGIC,UAAc,EACdV,mBAAA,CAUO;IAVAW,QAAM,EAJjBC,cAAA,CAI2BN,MAAA,CAAAO,WAAW;MAChCb,mBAAA,CAGM,cAFJc,UAAkC,E,gBAClCd,mBAAA,CAAiD;IAA1CE,IAAI,EAAC,MAAM;IAP1B,uBAAAa,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAOoCV,MAAA,CAAAW,QAAQ,GAAAD,MAAA;IAAEE,QAAQ,EAAR;iDAAVZ,MAAA,CAAAW,QAAQ,E,KAEtCjB,mBAAA,CAGM,cAFJmB,UAAiC,E,gBACjCnB,mBAAA,CAAqD;IAA9CE,IAAI,EAAC,UAAU;IAX9B,uBAAAa,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAWwCV,MAAA,CAAAc,QAAQ,GAAAJ,MAAA;IAAEE,QAAQ,EAAR;iDAAVZ,MAAA,CAAAc,QAAQ,E,KAE1CC,UAAiC,C,4BAExBf,MAAA,CAAAgB,WAAW,I,cAAtBlB,mBAAA,CAGM,OAHNmB,UAGM,GAlBVC,gBAAA,CAe0C,cAEpC,GAAAxB,mBAAA,CAAuC;IAA9ByB,OAAK,EAAEnB,MAAA,CAAAoB;EAAU,GAAE,IAAE,E,KAjBpCjB,mBAAA,e","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}